\documentclass[a4paper]{article}

\input{preamble}

\title{Stone duality for Boolean algebras}
\author{Sam van Gool}

\begin{document}
\maketitle
The aim of this note is to give a detailed proof of Stone duality for Boolean
algebras \cite{Sto1937BA} to facilitate its formalization in Mathlib. Note that
Stone actually proved something more general for bounded distributive lattices
\cite{Sto1937}.

\section{Definitions and statement}
I first recall some definitions from Mathlib. A subset $S$ of a topological
space is \emph{preconnected} if, whenever $U$ and $V$ are open subsets such
that $S \subseteq U \cup V$, $S \cap U \neq \emptyset$ and $S \cap V \neq
\emptyset$, we have $S \cap U \cap V \neq \emptyset$. A topological space is
\emph{totally disconnected} if any preconnected subset is a subsingleton. 

A Boolean space is a compact Hausdorff totally disconnected space.%
\footnote{What I call Boolean space is called \texttt{Profinite} in Mathlib and
is sometimes called `Stone space' by other mathematicians.} The category
$\BoolSp$ of Boolean spaces is the full subcategory of topological spaces based
on Boolean spaces.

A \emph{Boolean algebra} is, by definition a bounded distributive lattice with
complements. This means that it is a structure of the form $(A, \vee, \wedge,
\zer, \one, \neg)$ satisfying a number of axioms. We do not really care what
the axioms are precisely. What is important to know is that, for any set $X$,
the structure $(\mathcal{P}(X), \cup, \cap, \emptyset, X, (-)^{\c})$ is a
Boolean algebra (I believe and hope that this is in Mathlib, if not, it should
be.) A Boolean algebra \emph{homomorphism} is a structure-preserving function
between Boolean algebras. In fact, to be a homomorphism, it suffices to
preserve $\vee$, $\zer$, and $\neg$, because the operations $\one$ and $\wedge$
are term-definable from those. In particular, for a subset $S$ of a Boolean
algebra $A$ to be a subalgebra, it suffices for $S$ to contain $\zer$, and be
closed under the operations $\vee$ and $\neg$. An \emph{embedding} of Boolean
algebras is the same thing as an injective homomorphism.

\section{The functors}
We define the two functors that make up Stone duality.

\subsection{From spaces to algebras}
If $X$ is a Boolean space, write $\Clp(X)$ for the set of clopen
subsets of $X$. This is a subalgebra of the Boolean algebra $\mathcal{P}(X)$, since
finite unions and complements of clopen sets are clopen, and the empty set is
clopen; thus, $\Clp(X)$ is again a Boolean algebra. If $f \colon X \to Y$ is a
continuous function, then $f^{-1} \colon \Clp(Y) \to \Clp(X)$ is a Boolean
algebra homomorphism: indeed, $f^{-1}(\emptyset) = \emptyset$, $f^{-1}(K^\c) =
f^{-1}(K)^\c$, and $f^{-1}(K_1 \cup K_2) = f^{-1}(K_1) \cup f^{-1}(K_2)$. This
assignment is a contravariant functor because $\ms{id}_X^{-1}(K) = K$ and $(f
\circ g)^{-1}(K) = g^{-1}(f^{-1}(K))$. One sometimes writes $\Clp(f)$ for
$f^{-1}$ but the notation is a bit heavy.

\subsection{From algebras to spaces}
Let me write $\mbf{2} = \{ \zer, \one \}$ for the unique two-element Boolean
algebra; it can be seen as  an instance of the powerset algebra mentioned
above, where $X$ is a one-element set. If $A$ is a Boolean algebra, write
$\Spec(A)$ for the set of homomorphisms from $A$ to the Boolean algebra on two
elements. We equip $\Spec(A)$ with the topology generated by the basis
$(U_a)_{a \in A}$, where, for each $a \in A$, we define
\[ U_a \isdef \{ x \in \Spec(A) \ \mid \ x(a) = \one \} \ . \]
Note that each $U_a$ is clopen in the resulting topology on $\Spec(A)$. 
Also note that an equivalent way of defining this topology on $\Spec(A)$ is by
saying that it is the subspace topology induced by the $|A|$-fold power of the
discrete space $\mbf{2}$. 
Indeed,
we have 
\[ x \in (U_a)^\c \iff x(a) \neq \one \iff x(a) = \zer \iff x(\neg a) = \one
\iff x \in U_{\neg a} \ , \]
showing that the complement of $U_a$ is a (basic) open.
\begin{theorem}
    The topological space $\Spec(A)$ is a Boolean space.
\end{theorem}
\begin{proof}
    If $x, y \in \Spec(A)$ are distinct, then there is an element $a \in A$
    such that $x(a) \neq y(a)$. Without loss, say that $x(a) = \one$ and $y(a)
    = \zer$. Then $x \in U_a$ and $y \not\in U_a$. Thus, any two distinct
    elements are separated by a clopen set. This suffices to conclude that
    $\Spec(A)$ is totally disconnected by
    \href{https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Connected/TotallyDisconnected.html#isTotallyDisconnected_of_isClopen_set}{
    a result that is in Mathlib already}, and it also clearly implies that the
    space is Hausdorff. It remains to prove that $\Spec(A)$ is compact. This is
    where a weak form of axiom of choice must be used. An elegant way 
    is to show that the set of homomorphisms
    is closed as a subspace of $\mbf{2}^{|A|}$, and it is therefore compact,
    since $\mbf{2}^{|A|}$ is compact by Tychonoff's Theorem. In order to see
    that $\Spec(A)$ is closed in $\mbf{2}^{|A|}$, notice that
    \[ \Spec(A) = \bigcap_{a,b\in A} J_{a,b} \cap \bigcap_{a \in A} N_a \cap Z
    \ , \]
    where $J_{a,b} \isdef \{ x \in 2^A \ : \ x(a \vee b) = x(a) \vee x(b) \},$
    $N_a \isdef  \{x \in 2^A \ : \ x(\neg a) = \neg x(a) \},$ $Z \isdef \{ x
    \in 2^A \ : \ x(\zer) = \zer\}.$ Each of these sets is clopen because its
    definition only depends on a finite number of coordinates of $x$. For example, to
    spell this out a bit more,
    for any $a, b \in A$,
    \[ J_{a,b} = 
        (\pi_{a \vee b}^{-1}(\zer) \cap \pi_{a}^{-1}(\zer) \cap
        \pi_{b}^{-1}(\zer)) \cup (\pi_{a \vee b}^{-1}(\one) \cap
    (\pi_a^{-1}(\one) \cup \pi_b^{-1}(\one))) \ , \]
    where $\pi_c \colon \mbf{2}^A \to \mbf{2}$ is the projection onto the $c$
    coordinate.



    Here is a more concrete proof. By a well-known fact of topology that is
    hopefully in Mathlib, it suffices to prove the finite subcovering property
    with respect to the basis.  Let $T \subseteq A$ be a collection of elements
    with the property that $\bigcup_{a \in T} U_a = \Spec(A)$. Let $I$ be the
    ideal of $A$ generated by $T$. Here ideal means the same as in ring theory,
    but a more convenient definition is the following. This ideal can be
    described concretely as $$I = \{ b \in A \ \mid \ \text{ there is a finite
    } F \subseteq T \text{ such that } b \leq \bigvee F\}\ . $$ If we can prove
    that $\one \in I$, then we are done, because we have a finite $F \subseteq
    T$ such that $\bigvee F = \one$, and then, for any $x \in \Spec(A)$, we get
    \[ \one = x(\one) = x(\bigvee F) = \bigvee_{a \in F} x(a) \, \] so that
    $x(a) = \one$ for some $a \in F$.

    Towards a contradiction, suppose that $\one\not\in I$. By an application of
    Zorn's Lemma, there is a maximal ideal $J$ containing $I$ such that still
    $\one\not\in J$. Let $x \isdef \chi_J \colon A \to \mbf{2}$ be the characteristic function of $J$,
    that is, $x(a) = \zer$ if $a \in J$ and $x(a) = \one$ otherwise. One can
    now prove that $x$ is a homomorphism, as follows. By definition $\zer \in
    I$ so $\zer \in J$, so $x(\zer) = \zer$. Also, in any ideal, we have that
    $a \vee b \in I$ if, and only if, $a \in I$ and $b \in I$. This shows that
    $x(a \vee b) = x(a) \vee x(b)$. Finally, we need to show that $x$ preserves
    negation. Suppose that $x(a) = \one$, so that $a \not\in J$. We need to
    show that $\neg a \in J$. If $\neg a \not\in J$, then $\one$ is not in the
    ideal generated by $J \cup \{a\}$. But this ideal strictly contains $J$,
    contradicting the maximality of $J$. Thus, we must have $x(\neg a) = \zer$.
    Finally, if $x(a) = \zer$, then $a \in J$, and we cannot also have $\neg a
    \in J$, because that would imply $\one = a \vee \neg a$ is in $J$ as well,
    contradiction. Thus, $x(\neg a) = \one$.
\end{proof}
Given a homomorphism $f \colon A \to B$ we can now define $f_* \colon \Spec(B) \to \Spec(A)$
as the map that sends $y \colon B \to \mbf{2}$ to $y \circ f \colon A \to
\mbf{2}$. It is the composition of two homomorphisms, so it is again a
homomorphism. It is also continuous, because for any $a \in A$ and $y \in
\Spec(B)$, we have
\[ y \in f_*^{-1}(U_a) \iff f_*(y) \in U_a \iff y(f(a)) = \one \iff y \in
U_{f(a)}\ , \]
so that the inverse image $f_*^{-1}(U_a)$ of any basic open set is again a
(basic) open.
Thus, this assignment is well-defined, and one can now check that $f \mapsto
f_*$ is a contravariant functor. One sometimes writes $\Spec f$ for $f_*$ but
the notation is a bit heavy.

\section{The equivalence}

% \section{Characterization of Boolean spaces}
% The following equivalent definition of Boolean spaces is more convenient, and
% partly in Mathlib already. A space $X$ is called \emph{totally separated} if,
% for any distinct $x,y \in X$, there exist disjoint open sets $U, V \subseteq
% X$ such that $x \in U$ and $y \in V$.

% \begin{lemma}\label{lem:equiv-def-Boolean}
% A compact Hausdorff space $X$ is totally disconnected if, and only if, for any
% distinct $x, y \in X$, there exists a clopen set $K \subseteq X$ such that $x
% \in K$ and $y \not\in K$.
% \end{lemma}
% \begin{proof}
%    \href{https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Connected/TotallyDisconnected.html#isTotallyDisconnected_of_isClopen_set}{The
%     sufficiency is in Mathlib already}. The necessity is for example proved as
%     the implication (i) $\Rightarrow$ (ii) of \cite[Thm~II.4.2]{Joh1986} but I
%     think the following (extracted from there) is a bit simpler, given what is
%     already in Mathlib. Suppose that $X$ is a totally disconnected compact
%     Hausdorff space. It suffices to prove that $X$ is totally separated,
%     because it is in Mathlib that
%     \href{https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Connected/TotallyDisconnected.html#exists_isClopen_of_totally_separated}{the
%     separating set in any totally separated space can be chosen to be clopen}.
%     Let $x, y \in X$ be distinct. By total disconnectedness, since $\{x,y\}$ is
%     not connected,
%     \href{https://leanprover-community.github.io/mathlib4_docs/Mathlib/Topology/Connected/Basic.html#isPreconnected_closed_iff}{we
%     can pick} closed sets $F_1, F_2$ such that $\{x,y\} \subseteq F_1 \cup F_2$
%     and each $F_i$ has non-empty intersection with $\{x,y\}$, but $\{x,y\} \cap
%     F_1 \cap F_2 = \emptyset$. Without loss of generality, we have $x \in F_1$,
%     and then $x \not\in F_2$ (because $x$ is not in $F_1 \cap F_2)$, and
%     therefore (because $F_2$ has non-empty intersection with $\{x,y\}$), we
%     have  $y \in F_2$, so that $y \not\in F_1$ (because $y$ is not in $F_1 \cap
%     F_2$). Since $X$ is compact Hausdorff, it is regular, and we can pick
%     disjoint open sets $U$ and $V$ such that $F_1 \subseteq U$, $y \in V$. In
%     particular, $x \in U$, as required.
% \end{proof}


\end{document}
